// Copyright (c) 2023 Ziga Miklosic
// All Rights Reserved
// This software is under MIT licence (https://opensource.org/licenses/MIT)
////////////////////////////////////////////////////////////////////////////////
/**
*@file      serial.h
*@brief     Serial COM port
*@author    Ziga Miklosic
*@email     ziga.miklosic@gmail.com
*@date      31.10.2023
*@version   V0.1.0
*/
////////////////////////////////////////////////////////////////////////////////
/**
*@addtogroup SERIAL_API
* @{ <!-- BEGIN GROUP -->
*
*/
////////////////////////////////////////////////////////////////////////////////

#ifndef __SERIAL_H
#define __SERIAL_H

////////////////////////////////////////////////////////////////////////////////
// Includes
////////////////////////////////////////////////////////////////////////////////
#include <stdint.h>

#include <QList>
#include <QString>

#include <QSerialPort>
#include <QSerialPortInfo>

////////////////////////////////////////////////////////////////////////////////
// Definitions
////////////////////////////////////////////////////////////////////////////////


typedef struct
{
    uint32_t com_port;
    uint8_t baud;
} serial_cfg_t;

typedef struct
{
    QString name;    /**<COM Name */
    QString desc;    /**<COM Describtion */
} serial_info_t;


typedef enum
{
    eSERIAL_OK      = 0,
    eSERIAL_ERROR,
} serial_status_t;


/**
 *  Template Class
 */
class SerialPort
{
    ////////////////////////////////////////////////////////////////////////////////
    //  Public Methods
    ////////////////////////////////////////////////////////////////////////////////
    public:
        SerialPort(const serial_cfg_t * const p_cfg);
        ~SerialPort(void);


        serial_status_t serial_open     (const QSerialPortInfo & comPortInfo);
        serial_status_t serial_transmit (const uint8_t * const p_data, const uint32_t size);
        serial_status_t serial_receive  (uint8_t * const p_data);




        void show_ports(void);
        static const QList<serial_info_t> serial_ports_info(void);




    ////////////////////////////////////////////////////////////////////////////////
    //  Private Space
    ////////////////////////////////////////////////////////////////////////////////
    private:

        ////////////////////////////////////////////////////////////////////////////////
        //  Private Methods
        ////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////
        //  Private Variables
        ////////////////////////////////////////////////////////////////////////////////
        QSerialPort m_comPort;

};

#endif // __SERIAL_H

////////////////////////////////////////////////////////////////////////////////
/**
* @} <!-- END GROUP -->
*/
////////////////////////////////////////////////////////////////////////////////
